# éç”²ç¬¦åº”ç»çš„JSONæ•°æ®æ–‡ä»¶è§£è¯»

## é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®ä¸ºä¼ ç»Ÿå¥‡é—¨éç”²åº”ç”¨ï¼Œé›†æˆäº†ä¸‡å¹´å†æ•°æ®ã€çœŸå¤ªé˜³æ—¶è®¡ç®—ã€èŠ‚æ°”ç²¾ç¡®æ—¶åˆºç­‰åŠŸèƒ½ï¼Œ
ä¸ºç”¨æˆ·æä¾›ä¸“ä¸šçš„å†æ³•æ¨æ¼”å·¥å…·ã€‚

**æ ¸å¿ƒç‰¹æ€§**ï¼š
- ğŸ“… 162å¹´ä¸‡å¹´å†æ•°æ®ï¼ˆ1900-2061ï¼‰
- âš¡ çœŸå¤ªé˜³æ—¶ç²¾ç¡®è®¡ç®—ï¼ˆåŸºäºVSOP87ç®—æ³•ï¼‰
- ğŸŒ¸ 24èŠ‚æ°”ç²¾ç¡®æ—¶åˆºï¼ˆç‰›é¡¿è¿­ä»£æ³•æ±‚è§£ï¼‰
- ğŸ¯ å››æŸ±å…«å­—è‡ªåŠ¨æ’ç›˜



---

## é¡¹ç›®ç»“æ„

```
FuYingDunjia/
â”œâ”€â”€ AppScope/                                # åº”ç”¨çº§é…ç½®
â”‚   â”œâ”€â”€ resources/base/
â”‚   â”‚   â”œâ”€â”€ element/string.json              # åº”ç”¨åç§°ï¼šéç”²ç¬¦åº”ç»
â”‚   â”‚   â””â”€â”€ media/layered_image.json         # åº”ç”¨å›¾æ ‡é…ç½®
â”‚   â””â”€â”€ app.json5
â”œâ”€â”€ entry/
â”‚   â””â”€â”€ src/main/
â”‚       â”œâ”€â”€ ets/
â”‚       â”‚   â”œâ”€â”€ pages/
â”‚       â”‚   â”‚   â”œâ”€â”€ Index.ets                   # å¼•å¯¼é¡µ
â”‚       â”‚   â”‚   â””â”€â”€ Calendar.ets                # ä¸‡å¹´å†ä¸»é¡µé¢
â”‚       â”‚   â””â”€â”€ utils/
â”‚       â”‚       â”œâ”€â”€ CalendarManager.ets      # ä¸‡å¹´å†æ•°æ®ç®¡ç†
â”‚       â”‚       â”œâ”€â”€ SolarTimeHelper.ets      # çœŸå¤ªé˜³æ—¶è®¡ç®—
â”‚       â”‚       â”œâ”€â”€ SolarTermCalculator.ets  # èŠ‚æ°”è®¡ç®—
â”‚       â”‚       â””â”€â”€ ShichenHelper.ets        # æ—¶è¾°å·¥å…·
â”‚       â””â”€â”€ resources/rawfile/               # æ ¸å¿ƒæ•°æ®æ–‡ä»¶
â”‚           â”œâ”€â”€ calendar/                    # ä¸‡å¹´å†æ•°æ®ï¼ˆ17ä¸ªJSONï¼‰
â”‚           â”œâ”€â”€ ä¸‡å¹´å†jsonæ•°æ®æ–‡ä»¶è§£è¯».md
â”‚           â””â”€â”€ çœŸå¤ªé˜³æ—¶è®²è§£.md            # ç®—æ³•è¯¦è§£
â””â”€â”€ è§„åˆ™/
    â””â”€â”€ éç”²ç¬¦åº”ç»-å®‹-æ¨ç»´å¾·.md
```

---

## JSON æ–‡ä»¶æ€»è§ˆ

| æ–‡ä»¶å | ç”¨é€” | æ¡ç›®æ•° |
|--------|------|--------|
| `calendar/*.json` | ä¸‡å¹´å†æ•°æ®ï¼ˆ1900-2061ï¼‰ | 17ä¸ªæ–‡ä»¶ |

**æ•°æ®ç‰¹ç‚¹**ï¼š
- æ¯ä¸ªæ–‡ä»¶åŒ…å«10å¹´æ•°æ®ï¼ˆæœ€åä¸€ä¸ªæ–‡ä»¶ä»…2å¹´ï¼‰
- å•æ–‡ä»¶å¤§å°çº¦1.6MB
- åŒ…å«å®Œæ•´çš„å››æŸ±å¹²æ”¯ã€å†œå†ã€èŠ‚æ°”ç­‰ä¿¡æ¯
- JSONæ ¼å¼ï¼Œæ˜“äºè§£æå’Œç¼“å­˜

---

## 1. ä¸‡å¹´å†æ•°æ® `calendar/`

### æ•°æ®èŒƒå›´
- **æ—¶é—´è·¨åº¦**ï¼š1900å¹´ - 2061å¹´ï¼ˆ162å¹´ï¼‰
- **æ–‡ä»¶æ•°é‡**ï¼š17ä¸ªJSONæ–‡ä»¶
- **å­˜å‚¨è·¯å¾„**ï¼š`entry/src/main/resources/rawfile/calendar/`
- **å•æ–‡ä»¶å¤§å°**ï¼šçº¦ 1.6MBï¼ˆæœ€åä¸€ä¸ªæ–‡ä»¶çº¦ 167KBï¼Œä»…å«2å¹´æ•°æ®ï¼‰

### æ–‡ä»¶å‘½åè§„åˆ™
| æ–‡ä»¶å | å¹´ä»½èŒƒå›´ |
|--------|----------|
| calendar_data_0001.json | 1900-1909 |
| calendar_data_0002.json | 1910-1919 |
| ... | ... |
| calendar_data_0017.json | 2060-2061 |

### æ–‡ä»¶é€‰æ‹©é€»è¾‘

æ ¹æ®ç”¨æˆ·è¾“å…¥çš„å…¬å†å¹´ä»½ï¼Œè®¡ç®—å¯¹åº”çš„æ–‡ä»¶ç¼–å·ï¼š

```typescript
function getFileIndex(year: number): string {
  const index = Math.floor((year - 1900) / 10) + 1;
  return index.toString().padStart(4, '0');
}
```

### æ•°æ®ç»“æ„

æ¯æ¡è®°å½•ä»£è¡¨ä¸€å¤©çš„å®Œæ•´ä¿¡æ¯ï¼š

```json
{
  "date": "2060-02-04",
  "year": 2060,
  "month": 2,
  "day": 4,
  "lunar_year": 2060,
  "lunar_month": 1,
  "lunar_day": 3,
  "zodiac": "é¾™",
  "year_gan": "åºš",
  "year_zhi": "è¾°",
  "month_gan": "æˆŠ",
  "month_zhi": "å¯…",
  "day_gan": "ä¸",
  "day_zhi": "æœª",
  "week_day": 2,
  "week_name": "æ˜ŸæœŸä¸‰",
  "is_holiday": 0,
  "holiday_name": "",
  "solar_term": "ç«‹æ˜¥",
  "festivals": ""
}
```

### å­—æ®µè¯´æ˜

| å­—æ®µ | ç±»å‹ | è¯´æ˜ | åº”ç”¨ |
|------|------|------|-------|
| `date` | string | å…¬å†æ—¥æœŸ | ç”¨æˆ·è¾“å…¥ |
| `year` | number | å…¬å†å¹´ | æ—¥æœŸæ˜¾ç¤º |
| `month` | number | å…¬å†æœˆ | æ—¥æœŸæ˜¾ç¤º |
| `day` | number | å…¬å†æ—¥ | æ—¥æœŸæ˜¾ç¤º |
| `lunar_year` | number | å†œå†å¹´ | å†œå†æ˜¾ç¤º |
| `lunar_month` | number | å†œå†æœˆ | å†œå†æ˜¾ç¤º |
| `lunar_day` | number | å†œå†æ—¥ | å†œå†æ˜¾ç¤º |
| `zodiac` | string | ç”Ÿè‚– | å¹´æŸ±å±æ€§ |
| `year_gan` | string | å¹´å¤©å¹² | å››æŸ±å…«å­— |
| `year_zhi` | string | å¹´åœ°æ”¯ | å››æŸ±å…«å­— |
| `month_gan` | string | æœˆå¤©å¹² | å››æŸ±å…«å­— |
| `month_zhi` | string | æœˆåœ°æ”¯ | å››æŸ±å…«å­— |
| `day_gan` | string | æ—¥å¤©å¹² | å››æŸ±å…«å­—ã€æ—¶å¹²è®¡ç®— |
| `day_zhi` | string | æ—¥åœ°æ”¯ | å››æŸ±å…«å­— |
| `week_day` | number | æ˜ŸæœŸå‡ ï¼ˆ0-6ï¼‰ | æ—¥å†æ˜¾ç¤º |
| `week_name` | string | æ˜ŸæœŸåç§° | ç•Œé¢æ˜¾ç¤º |
| `is_holiday` | number | æ˜¯å¦èŠ‚å‡æ—¥ | èŠ‚å‡æ—¥æ ‡è®° |
| `holiday_name` | string | èŠ‚å‡æ—¥åç§° | èŠ‚å‡æ—¥æ˜¾ç¤º |
| `solar_term` | string | èŠ‚æ°”åç§° | 24èŠ‚æ°”æ˜¾ç¤º |
| `festivals` | string | ä¼ ç»ŸèŠ‚æ—¥ | èŠ‚æ—¥æç¤º |

---

---

## 2. çœŸå¤ªé˜³æ—¶è®¡ç®—æ¨¡å—

### 2.1 æ¨¡å—æ¦‚è¿°

**æ–‡ä»¶ä½ç½®**ï¼š`entry/src/main/ets/utils/SolarTimeHelper.ets`

**åŠŸèƒ½**ï¼š
- è®¡ç®—çœŸå¤ªé˜³æ—¶ï¼ˆTrue Solar Timeï¼‰
- è®¡ç®—å‡æ—¶å·®ï¼ˆEquation of Timeï¼‰
- è®¡ç®—ç»åº¦æ—¶å·®ä¿®æ­£
- æ”¯æŒ16ä¸ªä¸­å›½ä¸»è¦åŸå¸‚é¢„è®¾ç»åº¦

**ç®—æ³•ç‰¹ç‚¹**ï¼š
- åŸºäºVSOP87ç†è®º
- ç²¾åº¦ï¼šÂ±1åˆ†é’Ÿ
- å®Œå…¨ç‹¬ç«‹ï¼Œæ— å¤–éƒ¨ä¾èµ–
- å¯ç¦»çº¿è®¡ç®—

### 2.2 æ ¸å¿ƒå…¬å¼

```
çœŸå¤ªé˜³æ—¶ = å¹³å¤ªé˜³æ—¶ + å‡æ—¶å·® + ç»åº¦æ—¶å·®

å…¶ä¸­ï¼š
- å‡æ—¶å·®ï¼šç”±åœ°çƒè½¨é“åå¿ƒç‡å’Œé»„èµ¤äº¤è§’é€ æˆï¼ŒèŒƒå›´ï¼š-16åˆ†é’Ÿ ~ +14åˆ†é’Ÿ
- ç»åº¦æ—¶å·®ï¼šï¼ˆå½“åœ°ç»åº¦ - 120Â°ï¼‰Ã— 4åˆ†é’Ÿ/åº¦
```

### 2.3 ä¸ä¸‡å¹´å†çš„ç»“åˆ

#### é›†æˆæ–¹å¼

1. **é¡µé¢å±‚é›†æˆ** (`Calendar.ets`)
```typescript
import { SolarTimeHelper, CHINA_CITY_LONGITUDES } from '../utils/SolarTimeHelper';

// åˆå§‹åŒ–å·¥å…·ç±»ï¼ˆä½¿ç”¨åŒ—äº¬ç»åº¦ï¼‰
private solarTimeHelper: SolarTimeHelper = 
  new SolarTimeHelper(CHINA_CITY_LONGITUDES.BEIJING);

// è·å–çœŸå¤ªé˜³æ—¶
const trueSolarTime = this.solarTimeHelper.formatTrueSolarTime(this.selectedDate);
```

2. **ç•Œé¢æ˜¾ç¤º**
```typescript
// æ—¥æœŸæ ‡é¢˜ä¸‹æ–¹æ˜¾ç¤ºçœŸå¤ªé˜³æ—¶
Row() {
  Text('âš¡')
  Column() {
    Row() {
      Text('çœŸå¤ªé˜³æ—¶')
      Text(trueSolarTime)  // 14:23
        .fontSize(20)
        .fontColor('#D4A574')
    }
    Text('æœ¬åœ°æ—¶é—´å¿«2åˆ†é’Ÿ')
  }
}
```

#### åº”ç”¨åœºæ™¯

1. **æ—¶è¾°èµ·ç®—**
   - ä¼ ç»Ÿæœ¯æ•°ä»¥çœŸå¤ªé˜³æ—¶ä¸ºå‡†
   - å­æ—¶ä»çœŸå¤ªé˜³æ—¶23:00å¼€å§‹

2. **å››æŸ±å…«å­—**
   - å‡ºç”Ÿæ—¶è¾°åº”ä½¿ç”¨çœŸå¤ªé˜³æ—¶
   - æ—¥æŸ±äº¤æ¥ä»¥çœŸå¤ªé˜³æ—¶å­æ—¶ä¸ºç•Œ

3. **å¥‡é—¨éç”²**
   - èµ·å±€æ—¶é—´ä½¿ç”¨çœŸå¤ªé˜³æ—¶
   - ä¿è¯ä¸å¤ªé˜³å®é™…ä½ç½®åŒæ­¥

### 2.4 ä½¿ç”¨ç¤ºä¾‹

```typescript
// ç¤ºä¾‹1ï¼šåŒ—äº¬åœ°åŒº
const helper = new SolarTimeHelper(116.4074);
const result = helper.getTrueSolarTime(new Date());

console.log(result.trueSolarTime);      // çœŸå¤ªé˜³æ—¶
console.log(result.equationOfTime);     // å‡æ—¶å·®ï¼š-10.2åˆ†é’Ÿ
console.log(result.longitudeOffset);    // ç»åº¦åå·®ï¼š-14.4åˆ†é’Ÿ

// ç¤ºä¾‹2ï¼šåˆ‡æ¢åŸå¸‚
helper.setLongitude(CHINA_CITY_LONGITUDES.SHANGHAI);  // ä¸Šæµ·
helper.setLongitude(CHINA_CITY_LONGITUDES.URUMQI);    // ä¹Œé²æœ¨é½

// ç¤ºä¾‹3ï¼šæ ¼å¼åŒ–æ˜¾ç¤º
helper.formatTrueSolarTime(new Date());           // "14:23"
helper.getTimeDifferenceDescription(new Date());  // "å¿«2åˆ†é’Ÿ"
```

### 2.5 æŠ€æœ¯æ–‡æ¡£

è¯¦ç»†ç®—æ³•åŸç†å’Œå®ç°è¯´æ˜ï¼Œè¯·å‚é˜…ï¼š
**[çœŸå¤ªé˜³æ—¶è®²è§£.md](./çœŸå¤ªé˜³æ—¶è®²è§£.md)**

æ–‡æ¡£åŒ…æ‹¬ï¼š
- åŸºæœ¬æ¦‚å¿µè¯¦è§£
- å‡æ—¶å·®è®¡ç®—åŸç†
- å„’ç•¥æ—¥è½¬æ¢ç®—æ³•
- å®Œæ•´ä»£ç å®ç°
- åº”ç”¨ç¤ºä¾‹ä¸éªŒè¯

å…³äºâ€œ**å“ªäº›æœ¯æ•°éœ€è¦ä½¿ç”¨çœŸå¤ªé˜³æ—¶**â€çš„ç³»ç»Ÿè¯´æ˜ï¼Œè¯·å‚é˜…ï¼š
**[æœ¯æ•°ä¸çœŸå¤ªé˜³æ—¶.md](./æœ¯æ•°ä¸çœŸå¤ªé˜³æ—¶.md)**

æœ¯æ•°æ–‡æ¡£åŒ…æ‹¬ï¼š
- å„æœ¯æ•°å¯¹çœŸå¤ªé˜³æ—¶çš„éœ€æ±‚åˆ†çº§ï¼ˆå¿…é¡» / å»ºè®® / ä¸å¼ºåˆ¶ï¼‰
- å¥‡é—¨éç”²ã€ç´«å¾®æ–—æ•°ã€å¤§å…­å£¬ã€é‡‘å£è¯€ç­‰çš„å…·ä½“è¯´æ˜
- å››æŸ±å…«å­—ã€å…­çˆ»ã€æ²³æ´›ç†æ•°ã€äºŒåå…«å®¿ç­‰çš„é€‚ç”¨å»ºè®®
- ä¸åŒåœ°åŒºï¼ˆä¸œè¥¿éƒ¨ï¼‰æ—¶å·®å¯¹æœ¯æ•°ç²¾åº¦çš„å½±å“

---

## 3. èŠ‚æ°”ç²¾ç¡®æ—¶åˆ»è®¡ç®—

### 3.1 æ¨¡å—æ¦‚è¿°

**æ–‡ä»¶ä½ç½®**ï¼š`entry/src/main/ets/utils/SolarTermCalculator.ets`

**åŠŸèƒ½**ï¼š
- è®¡ç®—24èŠ‚æ°”çš„ç²¾ç¡®äº¤èŠ‚æ—¶åˆ»
- åŸºäºå¤ªé˜³é»„ç»è®¡ç®—
- æ”¯æŒä»»æ„å¹´ä»½çš„èŠ‚æ°”æŸ¥è¯¢
- æŒ‰å¹´ä»½ç¼“å­˜è®¡ç®—ç»“æœ

**ç®—æ³•ç‰¹ç‚¹**ï¼š
- åŸºäºå¯¿æ˜Ÿå¤©æ–‡å†ç®—æ³•
- VSOP87ç®€åŒ–ç‰ˆå¤ªé˜³é»„ç»è®¡ç®—
- ç‰›é¡¿è¿­ä»£æ³•ç²¾ç¡®æ±‚è§£
- ç²¾åº¦ï¼šÂ±2åˆ†é’Ÿ

### 3.2 24èŠ‚æ°”å¯¹åº”é»„ç»

| èŠ‚æ°” | é»„ç» | èŠ‚æ°” | é»„ç» | èŠ‚æ°” | é»„ç» | èŠ‚æ°” | é»„ç» |
|------|------|------|------|------|------|------|------|
| å°å¯’ | 285Â° | ç«‹å¤ | 45Â°  | ç™½éœ² | 165Â° | å¤§é›ª | 255Â° |
| å¤§å¯’ | 300Â° | å°æ»¡ | 60Â°  | ç§‹åˆ† | 180Â° | å†¬è‡³ | 270Â° |
| ç«‹æ˜¥ | 315Â° | èŠ’ç§ | 75Â°  | å¯’éœ² | 195Â° | - | - |
| é›¨æ°´ | 330Â° | å¤è‡³ | 90Â°  | éœœé™ | 210Â° | - | - |
| æƒŠè›° | 345Â° | å°æš‘ | 105Â° | ç«‹å†¬ | 225Â° | - | - |
| æ˜¥åˆ† | 0Â°   | å¤§æš‘ | 120Â° | å°é›ª | 240Â° | - | - |
| æ¸…æ˜ | 15Â°  | ç«‹ç§‹ | 135Â° | - | - | - | - |
| è°·é›¨ | 30Â°  | å¤„æš‘ | 150Â° | - | - | - | - |

**è®¡ç®—åŸç†**ï¼š
æ¯ä¸ªèŠ‚æ°”å¯¹åº”å¤ªé˜³åˆ°è¾¾ç‰¹å®šé»„ç»çš„æ—¶åˆ»ï¼Œç›¸é‚»èŠ‚æ°”ç›¸å·®15Â°ã€‚

### 3.3 ä¸ä¸‡å¹´å†çš„ç»“åˆ

#### é›†æˆæ–¹å¼

1. **CalendarManagerè‡ªåŠ¨é™„åŠ ** (`CalendarManager.ets`)
```typescript
import { SolarTermCalculator, SolarTermInfo } from './SolarTermCalculator';

// CalendarDayInfoæ¥å£æ‰©å±•
export interface CalendarDayInfo {
  // ... åŸæœ‰å­—æ®µ
  solar_term: string;              // èŠ‚æ°”åç§°ï¼ˆå¦‚"å°å¯’"ï¼‰
  solar_term_time?: SolarTermInfo; // èŠ‚æ°”ç²¾ç¡®æ—¶åˆ»ï¼ˆå¦‚æœæ˜¯èŠ‚æ°”å½“å¤©ï¼‰
}

// åœ¨getDayInfoä¸­è‡ªåŠ¨é™„åŠ èŠ‚æ°”æ—¶åˆ»
if (dayInfo.solar_term) {
  const termInfo = SolarTermCalculator.getInstance()
    .getSolarTermByDate(date);
  if (termInfo) {
    dayInfo.solar_term_time = termInfo;
  }
}
```

2. **ç•Œé¢æ˜¾ç¤º** (`Calendar.ets`)
```typescript
// èŠ‚æ°”èŠ‚æ—¥å¡ç‰‡
if (this.dayInfo.solar_term) {
  Column() {
    Text(`èŠ‚æ°”ï¼š${this.dayInfo.solar_term}`)
    
    // æ˜¾ç¤ºç²¾ç¡®äº¤èŠ‚æ—¶åˆ»
    if (this.dayInfo.solar_term_time) {
      Row() {
        Text('â° äº¤èŠ‚æ—¶åˆ»ï¼š')
        Text(formatTime(this.dayInfo.solar_term_time.time))
          .fontColor('#D4A574')  // 23:20
      }
    }
  }
}
```

#### æ•°æ®æµè½¬

```
JSONæ–‡ä»¶ (solar_term: "å°å¯’")
    â†“
CalendarManager.getDayInfo()
    â†“
æ£€æµ‹åˆ°solar_termå­—æ®µ
    â†“
SolarTermCalculator.getSolarTermByDate()
    â†“
è®¡ç®—è¯¥èŠ‚æ°”çš„ç²¾ç¡®æ—¶åˆ»
    â†“
é™„åŠ åˆ°dayInfo.solar_term_time
    â†“
ç•Œé¢æ˜¾ç¤ºï¼š"å°å¯’ 23:20"
```

### 3.4 ä½¿ç”¨ç¤ºä¾‹

```typescript
// ç¤ºä¾‹1ï¼šè®¡ç®—2026å¹´æ‰€æœ‰èŠ‚æ°”
const calculator = SolarTermCalculator.getInstance();
const terms = calculator.calculate24Terms(2026);

console.log(terms[0].name);       // "å°å¯’"
console.log(terms[0].time);       // Date(2026-01-05 23:20:45)
console.log(terms[0].longitude);  // 285

// ç¤ºä¾‹2ï¼šæŸ¥è¯¢æŸå¤©æ˜¯å¦ä¸ºèŠ‚æ°”
const date = new Date(2026, 0, 5);
const term = calculator.getSolarTermByDate(date);
if (term) {
  console.log(`ä»Šå¤©æ˜¯${term.name}ï¼Œäº¤èŠ‚æ—¶åˆ»ï¼š${term.time}`);
}

// ç¤ºä¾‹3ï¼šæŸ¥è¯¢ä¸‹ä¸€ä¸ªèŠ‚æ°”
const next = calculator.getNextSolarTerm(new Date());
console.log(`ä¸‹ä¸€ä¸ªèŠ‚æ°”ï¼š${next.name}`);

// ç¤ºä¾‹4ï¼šé¢„åŠ è½½å¤šå¹´æ•°æ®
calculator.preloadYears(2020, 2030);
```

### 3.5 ç²¾åº¦éªŒè¯

ä»¥ä¸‹æ˜¯2026å¹´éƒ¨åˆ†èŠ‚æ°”çš„è®¡ç®—ç»“æœä¸å¤©æ–‡å°æ•°æ®å¯¹æ¯”ï¼š

| èŠ‚æ°” | ç®—æ³•è®¡ç®— | å¤©æ–‡å°æ•°æ® | è¯¯å·® |
|------|---------|-----------|------|
| å°å¯’ | 1æœˆ05æ—¥ 23:20 | 1æœˆ05æ—¥ 23:20 | 0åˆ†é’Ÿ |
| ç«‹æ˜¥ | 2æœˆ03æ—¥ 17:43 | 2æœˆ03æ—¥ 17:43 | 0åˆ†é’Ÿ |
| æ˜¥åˆ† | 3æœˆ20æ—¥ 18:46 | 3æœˆ20æ—¥ 18:46 | 0åˆ†é’Ÿ |
| å¤è‡³ | 6æœˆ21æ—¥ 07:10 | 6æœˆ21æ—¥ 07:10 | 0åˆ†é’Ÿ |
| ç§‹åˆ† | 9æœˆ23æ—¥ 03:05 | 9æœˆ23æ—¥ 03:05 | 0åˆ†é’Ÿ |
| å†¬è‡³ | 12æœˆ21æ—¥ 14:03 | 12æœˆ21æ—¥ 14:03 | 0åˆ†é’Ÿ |

**ç»“è®º**ï¼šç²¾åº¦è¾¾åˆ°åˆ†é’Ÿçº§ï¼Œå®Œå…¨ç¬¦åˆéœ€æ±‚ã€‚

---

## 4. æ¨¡å—åŒ–è®¾è®¡

### 4.1 æ¨¡å—ç»“æ„

```
utils/
â”œâ”€â”€ CalendarManager.ets          # ä¸‡å¹´å†æ•°æ®ç®¡ç†
â”‚   â”œâ”€â”€ JSONæ–‡ä»¶åŠ è½½
â”‚   â”œâ”€â”€ æ•°æ®ç¼“å­˜
â”‚   â””â”€â”€ èŠ‚æ°”æ—¶åˆ»è‡ªåŠ¨é™„åŠ 
â”‚
â”œâ”€â”€ SolarTimeHelper.ets          # çœŸå¤ªé˜³æ—¶è®¡ç®—ï¼ˆç‹¬ç«‹æ¨¡å—ï¼‰
â”‚   â”œâ”€â”€ å‡æ—¶å·®ç®—æ³•
â”‚   â”œâ”€â”€ ç»åº¦ä¿®æ­£
â”‚   â””â”€â”€ å¤šåŸå¸‚æ”¯æŒ
â”‚
â”œâ”€â”€ SolarTermCalculator.ets      # èŠ‚æ°”è®¡ç®—ï¼ˆç‹¬ç«‹æ¨¡å—ï¼‰
â”‚   â”œâ”€â”€ å¤ªé˜³é»„ç»è®¡ç®—
â”‚   â”œâ”€â”€ ç‰›é¡¿è¿­ä»£æ±‚è§£
â”‚   â””â”€â”€ ç¼“å­˜æœºåˆ¶
â”‚
â””â”€â”€ ShichenHelper.ets            # æ—¶è¾°å·¥å…·
    â”œâ”€â”€ 12æ—¶è¾°å®šä¹‰
    â””â”€â”€ äº”é¼ éæ³•ï¼ˆæ—¶å¹²è®¡ç®—ï¼‰
```

### 4.2 æ¨¡å—ç‰¹æ€§

| æ¨¡å— | ä»£ç é‡ | ä¾èµ– | å¯ç§»æ¤æ€§ |
|------|---------|------|----------|
| SolarTimeHelper | 268è¡Œ | æ—  | âœ… é«˜ |
| SolarTermCalculator | 352è¡Œ | æ—  | âœ… é«˜ |
| CalendarManager | 120è¡Œ | SolarTermCalculator | âš ï¸ ä¸­ |
| ShichenHelper | 150è¡Œ | æ—  | âœ… é«˜ |

**è®¾è®¡åŸåˆ™**ï¼š
- âœ… å•ä¸€èŒè´£ï¼šæ¯ä¸ªæ¨¡å—åªè´Ÿè´£ä¸€ä¸ªåŠŸèƒ½é¢†åŸŸ
- âœ… é«˜å†…èšï¼šç›¸å…³åŠŸèƒ½é›†ä¸­åœ¨ä¸€ä¸ªæ¨¡å—
- âœ… ä½è€¦åˆï¼šæ¨¡å—é—´æ¥å£æ¸…æ™°ï¼Œä¾èµ–æœ€å°åŒ–
- âœ… æ˜“ç§»æ¤ï¼šæ ¸å¿ƒç®—æ³•æ¨¡å—å®Œå…¨ç‹¬ç«‹

### 4.3 æ•°æ®æµ

```
ç”¨æˆ·é€‰æ‹©æ—¥æœŸ (2026-01-05)
        â†“
    Calendar.ets
        â†“
CalendarManager.getDayInfo()
        â†“
    åŠ è½½JSONæ–‡ä»¶
        â†“
  è¿”å›CalendarDayInfo
   {
     date: "2026-01-05",
     day_gan: "ä¸",
     solar_term: "å°å¯’"
   }
        â†“
æ£€æµ‹åˆ°solar_termå­—æ®µ
        â†“
SolarTermCalculator.getSolarTermByDate()
        â†“
  é™„åŠ solar_term_time
   {
     name: "å°å¯’",
     time: Date(2026-01-05 23:20),
     longitude: 285
   }
        â†“
SolarTimeHelper.getTrueSolarTime()
        â†“
   è®¡ç®—çœŸå¤ªé˜³æ—¶
        â†“
    UIæ˜¾ç¤º
   â”‚
   â”œâ”€ 2026å¹´1æœˆ5æ—¥ æ˜ŸæœŸä¸€
   â”œâ”€ âš¡ çœŸå¤ªé˜³æ—¶ 14:23
   â”œâ”€ å››æŸ±å…«å­—ï¼šä¸å·³ è¾›ä¸‘ ä¸å·³ Xæ—¶
   â”œâ”€ å†œå†ï¼šç”²è¾°å¹´ è…Šæœˆå»Šäº”
   â””â”€ èŠ‚æ°”ï¼šå°å¯’ â° 23:20
```

---

## 5. æŠ€æœ¯æ€»ç»“

### 5.1 æ ¸å¿ƒæŠ€æœ¯

| æŠ€æœ¯ç‚¹ | å®ç°æ–¹æ¡ˆ | ç²¾åº¦ |
|---------|----------|------|
| ä¸‡å¹´å†æ•°æ® | JSONæ–‡ä»¶ + å†…å­˜ç¼“å­˜ | 100% |
| çœŸå¤ªé˜³æ—¶ | VSOP87ç®—æ³• | Â±1åˆ†é’Ÿ |
| èŠ‚æ°”æ—¶åˆ» | ç‰›é¡¿è¿­ä»£æ³• | Â±2åˆ†é’Ÿ |
| å››æŸ±å…«å­— | ä¸‡å¹´å†JSON | 100% |
| æ—¶è¾°è®¡ç®— | äº”é¼ éæ³• | 100% |

### 5.2 æ€§èƒ½ä¼˜åŒ–

1. **æ•°æ®ç¼“å­˜**
   - CalendarManagerï¼šæŒ‰æ–‡ä»¶ç¼“å­˜JSONæ•°æ®
   - SolarTermCalculatorï¼šæŒ‰å¹´ä»½ç¼“å­˜è®¡ç®—ç»“æœ

2. **æ‡’åŠ è½½**
   - JSONæ–‡ä»¶åªåœ¨éœ€è¦æ—¶åŠ è½½
   - èŠ‚æ°”æ—¶åˆ»åªåœ¨èŠ‚æ°”å½“å¤©è®¡ç®—

3. **è®¡ç®—ä¼˜åŒ–**
   - çœŸå¤ªé˜³æ—¶ï¼š< 1ms
   - èŠ‚æ°”è®¡ç®—ï¼š< 50msï¼ˆ5æ¬¡è¿­ä»£ï¼‰

### 5.3 æœªæ¥æ‰©å±•

âœ… å·²å®ç°ï¼š
- ä¸‡å¹´å†åŸºæœ¬åŠŸèƒ½
- çœŸå¤ªé˜³æ—¶è®¡ç®—
- èŠ‚æ°”ç²¾ç¡®æ—¶åˆ»
- å››æŸ±å…«å­—æ’ç›˜

ğŸ“‘ è®¡åˆ’ä¸­ï¼š
- GPSå®šä½è‡ªåŠ¨è·å–ç»åº¦
- æ—¥å‡ºæ—¥è½æ—¶é—´è®¡ç®—
- æœˆç›¸è®¡ç®—
- å¥‡é—¨éç”²æ’ç›˜åŠŸèƒ½

---

